Red Wine Quality EDA by Anas Haneya
========================================================

```{r message=FALSE, warning=FALSE, include=FALSE}
# Load all of the packages that you end up using in your analysis in this code
# chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk. This
# prevents the code from displaying in the knitted HTML output. You should set
# echo=FALSE for all code chunks in your file, unless it makes sense for your
# report to show the code that generated a particular plot.

# The other parameters for "message" and "warning" should also be set to FALSE
# for other code chunks once you have verified that each plot comes out as you
# want it to. This will clean up the flow of your report.

library(ggplot2)
library(tidyr)
library(gridExtra)
library(dplyr)
library(GGally)
```

```{r}
#Disabling all messages, wornings and echo
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
```


```{r echo=FALSE, Load_the_Data}
# Load the Data
red <- read.csv('wineQualityReds.csv')
```

**Public Data Set about Red Wine with 13 variable and 1599 observation**

# Univariate Plots Section

```{r echo=FALSE, structure}
# Data structure
str(red)
```


```{r echo=FALSE, dim}
# Dataset dimensions
dim(red)
```


```{r echo=FALSE, summary}
# dataset 5 number summary
summary(red)
```

```{r echo=FALSE, nulls_check}
# nulls check
sum(is.na(red))
```

```{r function_univariate}
# Function to avoid redunduncy

uni_fun <- function(dataset, feature, title, xlabel = NULL,
                    ylabel = 'Count', binwidth = NULL) {

  return(ggplot(data = dataset, aes_string(x = feature))
              + geom_histogram(binwidth = binwidth) +
                ggtitle(title) +
                xlab(xlabel) +
                ylab(ylabel))
}
```


```{r echo=FALSE, message=FALSE, warning=FALSE, quality_plot}
# using ggplot2 library
uni_fun(red, 'quality', 'Histogram of wine qualities distrubition', 
        'Quality (0-10)', 'Count')
```

**Most of the wine samples are centered on 5, 6, 7 the extreme low and extreme \
low can be considered as outliers or not enough samples**

```{r echo=FALSE, message=FALSE, warning=FALSE, density}
#Histogram of density
uni_fun(red, 'density', 'Histogram of wine densities distrubition',
        'Density (g / cm^3)', 'Count')
```

**Density of the wine is normally distributed**

```{r echo=FALSE, message=FALSE, warning=FALSE, fixed.acidity}
#histogram of fixed.acidity
uni_fun(red, 'fixed.acidity', 'Histogram of wine fixed acidity distrubition')
```

**Most of the fixed acidity data is between 6 and 10 and the plot is right \
skewed**

```{r echo=FALSE, message=FALSE, warning=FALSE,fixed.acidity_plot2}
#fixed.acidity with a smaller binwidth and a bit of zooming
uni_fun(red, 'fixed.acidity', 'Histogram of wine fixed acidity distrubition',
        'fixed acidity (tartaric acid - g / dm^3)' , 'Count' ,0.1) +
  scale_x_continuous(breaks = seq(4,12,1), limits = c(4.5,13))
```

**Most of the fixed acidity data is between 6 and 10 and the plot is right \
skewed the second plot shows the variation of the data points after using the \ 
binwidth and scale_x_continous, for the second plot after zooming in using \
limits assuming that the points from 13 to 17 are outliers, we can see fixed \
acidity is almost normally distribited**


```{r echo=FALSE, message=FALSE, warning=FALSE, volatile.acidity}
#Histogram of volatile.acidity
uni_fun(red, 'volatile.acidity', 
        'Histogram of wine Volatile Acidity distrubition',
        'volatile acidity (acetic acid - g / dm^3)','Count')
```

**Data points are between 0.2 and 0.8 and the plot is right skewed**


```{r echo=FALSE, message=FALSE, warning=FALSE, volatile.acidity_plot}
#Histogram of volatile.acidity with a smaller binwidth
uni_fun(red, 'volatile.acidity', 
        'Histogram of wine Volatile Acidity distrubition',
        'volatile acidity (acetic acid - g / dm^3)','Count', 0.01) +
  scale_x_continuous(breaks = seq(0,1.6,0.1))
```

**Data points are between 0.2 and 0.8 and the plot is right skewed**


```{r echo=FALSE, message=FALSE, warning=FALSE, citric.acid}
#Histogram of citric acid
uni_fun(red, 'citric.acid', 
        'Histogram of wine Citric Acid distrubition',
        'citric acid (g / dm^3)','Count') 
```

**Citric acid at 0.0 has the highest count next to it 0.50**

```{r echo=FALSE, message=FALSE, warning=FALSE, citric.acid_plot}
#Histogram of citric acid with smaller binwidth and with zooming
uni_fun(red, 'citric.acid', 
        'Histogram of wine Citric Acid distrubition',
        'citric acid (g / dm^3)','Count',0.01) +
  coord_cartesian(xlim = c(0,0.8)) +
  scale_x_continuous(breaks = seq(0,0.8,0.1))
```

**Citric acid at 0.0 has the highest count next to it 0.50, by setting the \
binwidth to 0.01 and zooing in to take out the outliers we have a clear view \
over the data distribution**

```{r echo=FALSE, message=FALSE, warning=FALSE, residual.sugar}
#histogram of residual sugar
uni_fun(red, 'residual.sugar', 'Histogram of wine Residual Sugar distrubition',
        'residual sugar (g / dm^3)')
```

**Right skewed plot with most of the data points at 2**


```{r echo=FALSE, message=FALSE, warning=FALSE, residual.sugar_plot}
#histogram of residual sugar with a smaller binwidth
uni_fun(red, 'residual.sugar', 'Histogram of wine Residual Sugar distrubition',
        'residual sugar (g / dm^3)',,0.1) +
coord_cartesian(xlim = c(0.6,8.1)) + 
scale_x_continuous(breaks = seq(0.6,8.1,1))
```

**Right skewed plot with most of the data points at 2, I will note zoom in \
further as I will loose a lot of data points and we have a small number of \
observations**


```{r echo=FALSE, message=FALSE, warning=FALSE, chlorides}
#HIstogram of Chlorides
uni_fun(red, 'chlorides', 'Histogram of wine Chlorides distrubition',
        'chlorides (sodium chloride - g / dm^3)')
```

**Right skewed plot with most of the points around 0.1**

```{r echo=FALSE, message=FALSE, warning=FALSE, free.sulfur.dioxide}
uni_fun(red, 'free.sulfur.dioxide',
        'Histogram of wine Free Sulfur Dioxide distrubition',
        'free sulfur dioxide (mg / dm^3)')
```

**Right skewed plot with lower values having more count and probably any \
 thing more than 40 could be an outlier**
 
```{r echo=FALSE, message=FALSE, warning=FALSE, total.sulfur.dioxide}
#Total Sulfur dioxide histogram with log10 transformation
uni_fun(red, 'total.sulfur.dioxide',
'Histogram of wine Total Sulfur Dioxide distrubition',
'total sulfur dioxide (mg / dm^3)') 
``` 

**Right skewed plot**

```{r echo=FALSE, message=FALSE, warning=FALSE, pH_plot}
#Histogram of the pH
uni_fun(red,'pH','Histogram of wine pH distrubition', 'pH', 'Count' ,0.01)
``` 

**pH is nomrmally distributied**

```{r echo=FALSE, message=FALSE, warning=FALSE, sulphates_plot}
#Histogram of sulphates
uni_fun(red,'sulphates','Histogram of wine Sulphate distrubition', 
        'sulphates (potassium sulphate - g / dm3)','Count',0.01)
``` 

**Right skewed plot with values 0.3 to 1.0**

```{r echo=FALSE, message=FALSE, warning=FALSE, alcohol_plot}
#Histogram of the alcohol percentage by volume distribution in the dataset
uni_fun(red, 'alcohol', 'Histogram of wine Alcohol distribution', 
        'alcohol (% by volume)',,0.1)
``` 


# Univariate Analysis

### What is the structure of your dataset?

- 12 variable (feature) with one outcome (quality).
- 1599 Observations.
- Quality is a catagorical variable ordered from 0-10 where 0 is very bad and \ 
10 very excellent and needs to be converted into ordered factor.
- There other 11 variables are numrics (float).

### What is/are the main feature(s) of interest in your dataset?
- Residual.sugar
- Alcohol
- Volitile.acidity
- Citric.acid
- Quality
I will keep investigating to see a relevant other main feature in the dataset

### What other features in the dataset do you think will help support your \
investigation into your feature(s) of interest?
- pH
- total.sulfur.dioxide
- fixed.acidity
- density

### Did you create any new variables from existing variables in the dataset?
No

### Of the features you investigated, were there any unusual distributions? \
Did you perform any operations on the data to tidy, adjust, or change the form \
of the data? If so, why did you do this?
No, data is tidy from, and data quality is good, I just a change on the data \
type of quality to become ordered factor


# Bivariate Plots Section

```{r, changing_quality_datatype}
#changing the quality data type to ordered factor instead of integer which fits
#the nature of this feature
red$quality <- as.ordered(red$quality)
```

```{r}
#create a function to reduce redunduncy 
#This function takes 6 parameters to dynamically plot:
# dataset (dataframe), x (x - axis), y (y-axis), xlabel, ylabel,
# alpha for scatter plot with a default value of 1

bi_fun <- function(dataset, x , y, xlabel, ylabel, alpha = 1) {
    #setting len_out to 8 to be default for non factor variables
    # len_out <- 8
    #defining df, df$c and df$y to avoid the ggplot issue if assiging the 
    #variables
    df <- dataset
    df$x = df[,which(names(df)==x)]
    df$y = df[,which(names(df)==y)]
    # converting order factor to integer for ploting
    if (class(df$x)[1] == "ordered" | class(df$x)[1] == "factor") {
        df$x <- as.integer(as.vector(df$x))
        # len_out <- 6
    }
    if (class(df$y)[1] == "ordered" | class(df$y)[1] == "factor") {
        df$y <- as.integer(as.vector(df$y))
        # len_out <- 6
    }
  return(ggplot(data = df, aes(x = df$x, y= df$y))+
           geom_point(alpha = alpha, position = 'jitter') +
           # scale_x_continuous(breaks = seq(min(df$x), quantile(df$x,0.99),
           #                                 length.out = len_out)) +
           # scale_y_continuous(breaks = seq(min(df$y), quantile(df$y,0.99), 
           #                                 length.out = len_out)) +
           coord_cartesian( xlim = c(min(df$x), quantile(df$x,0.99)),
                            ylim = c(min(df$y), quantile(df$y,0.99))) +
           xlab(xlabel) +
           ylab(ylabel))
}
```


```{r echo=FALSE, fig.height=max, fig.width=max, message=FALSE, warning=FALSE}
# Scatter plot of Residual.sugar & alcohol
bi_fun(red, 'residual.sugar','alcohol', 'residual sugar (g / dm^3)',
       'alcohol (% by volume)', 0.5) +
      ggtitle('Scatter plot of Residual.sugar & alcohol with a line smoother') +
      geom_smooth()
```

**There is no significant relation between the residual.sugra and alcohol**

```{r echo=FALSE, message=FALSE, warning=FALSE, density_alcohol}
# Scatter plot of Density & alcohol
bi_fun(red, 'density', 'alcohol', 'density (g / cm^3)', 'alcohol (% by volume)',
       0.25) +
  ggtitle('Scatter plot of Density & alcohol with line smoother') + 
  geom_smooth()
```

**There is a -ve kind of strong correlation between alcohol and density**

```{r echo=FALSE, message=FALSE, warning=FALSE, quality_volatile.acidity}
# Scatter plot of Quality with Volatile.acidity
bi_fun(red, 'quality','volatile.acidity', 'Quality (0-10)',
       'volatile acidity (acetic acid - g / dm^3)', 0.3) +
  ggtitle('Scatter plot of Quality with Volatile.acidity') +
  geom_line(stat = 'summary', fun.y = mean, aes(color = 'Mean')) +
  geom_line(stat = 'summary', fun.y = median, aes(color = 'Median')) +
  scale_color_manual(values = c('Mean' = 'red', 'Median' = 'blue')) +
  labs(color = 'Lines')
```

**It seems with decrese of the volatile.acidity the quality increases on average**

```{r echo=FALSE, message=FALSE, warning=FALSE, chlorides_quality}
# Scatter plot of Quality with chlorides
bi_fun(red, 'quality','chlorides', 'Quality (0-10)',
       'chlorides (sodium chloride - g / dm^3)', 0.3) +
  ggtitle('Scatter plot of Quality with chlorides') +
  geom_line(stat = 'summary', fun.y = mean, aes(color = 'Mean')) +
  geom_line(stat = 'summary', fun.y = median, aes(color = 'Median')) +
  scale_color_manual(values = c('Mean' = 'red', 'Median' = 'blue')) +
  labs(color = 'Lines')
  
```

**Quality at its best when the chlorides is between 0.05 and  0.1, also I can \
see that with the decrese of chlorides on average the quality goes up**

```{r echo=FALSE, message=FALSE, warning=FALSE, total.sulfur.dioxide_quality}
ggplot(data = red, aes(y = total.sulfur.dioxide,
                       x= as.integer(as.vector(quality)))) +
  geom_point(alpha = .5, position = 'jitter') +
  scale_y_continuous(breaks = seq(0,quantile(red$total.sulfur.dioxide,0.99),5))+
  scale_x_continuous(breaks = seq(3,
                              quantile(with(red,as.integer(as.vector(quality)))
                                           ,0.99))) +
  coord_cartesian(ylim = c(min(red$total.sulfur.dioxide),
                           quantile(red$total.sulfur.dioxide,0.99)),
                  xlim = c(3,
                           quantile(with(red,as.integer(as.vector(quality)))
                                    ,0.99))) +
  xlab('Quality') +
  geom_line(fun.y = mean, stat = 'summary')
```

**lower Total sulfur dioxide (TSD) is a contributor to better quality, however \ 
I see a lower TSD with a lower  quality rating, this could be related to \ 
correlated variable another point to be considered is that there is not enough \
samples with quality level 3, 4, 8**

```{r echo=FALSE, message=FALSE, warning=FALSE, free.sulfur.dioxide_quality}
ggplot(data = red, aes(y = free.sulfur.dioxide,
                       x= as.integer(as.vector(quality)))) +
  geom_point(alpha = .3, position = 'jitter') +
  scale_y_continuous(breaks = seq(0,quantile(red$free.sulfur.dioxide,0.99),5))+
  scale_x_continuous(breaks = seq(3,
                              quantile(with(red,as.integer(as.vector(quality)))
                                           ,0.99))) +
  coord_cartesian(ylim = c(min(red$free.sulfur.dioxide),
                           quantile(red$free.sulfur.dioxide,0.99)),
                  xlim = c(3,
                           quantile(with(red,as.integer(as.vector(quality)))
                                    ,0.99))) +
  xlab('Quality')
```

**From the first look and due the not enough samples of quality level 7 and 8 \
it seems that this variable isn't contributing much to quality**

```{r echo=FALSE, message=FALSE, warning=FALSE, sulphates_quality}
ggplot(data = red, aes(y = sulphates, x= as.integer(as.vector(quality)))) +
  geom_point(alpha = .3, position = 'jitter') +
  scale_y_continuous(breaks = seq(0,quantile(red$sulphates,0.99),0.1))+
  scale_x_continuous(breaks = seq(3,
                              quantile(with(red,as.integer(as.vector(quality)))
                                           ,0.99))) +
  coord_cartesian(ylim = c(min(red$sulphates),
                           quantile(red$sulphates,0.99)),
                  xlim = c(3,
                           quantile(with(red,as.integer(as.vector(quality)))
                                    ,0.99))) +
  xlab('Quality') +
  geom_line(stat = 'summary', fun.y = median, color = 'red') +
  geom_line(stat = 'summary', fun.y = mean, color = 'blue')
```

**Sulphates & Quality: drawing the mean and median layers showed that the \ 
increase of sulphates contributes to better quality.**

```{r echo=FALSE, message=FALSE, warning=FALSE, density_quality}
ggplot(data = red, aes(y = density, x= as.integer(as.vector(quality)))) +
  geom_point(alpha = .2, position = 'jitter') +
  scale_y_continuous(breaks = seq(0,quantile(red$density,0.99),0.001))+
  scale_x_continuous(breaks = seq(3,
                              quantile(with(red,as.integer(as.vector(quality)))
                                           ,0.99))) +
  coord_cartesian(ylim = c(min(red$density),
                           quantile(red$density,0.99)),
                  xlim = c(3,
                           quantile(with(red,as.integer(as.vector(quality)))
                                    ,0.99))) +
  xlab('Quality') +
  geom_line(stat = 'summary', fun.y = median, color = 'red') +
  geom_line(stat = 'summary', fun.y = mean, color = 'blue')
```

**This Analysis Didn't help much as I see most of the data is between 0.995 and \
0.998 of density**

```{r echo=FALSE, message=FALSE, warning=FALSE, alcohol_quality}
ggplot(data = red, aes(y = alcohol, x= as.integer(as.vector(quality)))) +
  geom_point(alpha = .06, position = 'jitter') +
  scale_y_continuous(breaks = seq(0,quantile(red$alcohol,0.99),0.5))+
  scale_x_continuous(breaks = seq(3,
                              quantile(with(red,as.integer(as.vector(quality)))
                                           ,0.99))) +
  coord_cartesian(ylim = c(min(red$alcohol),
                           quantile(red$alcohol,0.99)),
                  xlim = c(3,
                           quantile(with(red,as.integer(as.vector(quality)))
                                    ,0.99))) +
  xlab('Quality')+
  geom_line(stat = 'summary', fun.y = median, color = 'red') +
  geom_line(stat = 'summary', fun.y = mean, color = 'blue')
  
```

**Alcohol does affect the quality as per the plot, as I see a trend with the \ 
increase of the alcohol**


```{r echo=FALSE, message=FALSE, warning=FALSE, sulphates_alcohol}
ggplot(data = red, aes(x = sulphates, y= alcohol)) +
  geom_point(aes(color = 'orange'), alpha = 1/5, position = 'jitter') +
  scale_x_continuous(breaks = seq(0,max(red$sulphates),.1))+
  scale_y_continuous(breaks = seq(0,max(red$alcohol),.5)) +
  coord_cartesian(xlim = c(min(red$sulphates),
                           quantile(red$sulphates,0.99)),
                  ylim = c(min(red$alcohol),
                           quantile(red$alcohol,0.99))) +
  geom_smooth()
```

**It seems that there is a relation between the sulphates and alcohol, increase \
of alcohol there is an increase of sulphates however with sulphates value of \
~0.8 the relationship changes, I assume the 0.7 and 0.8 are the optimal values**

```{r echo=FALSE, message=FALSE, warning=FALSE, sulphates_free.sulfur.dioxide}
ggplot(data = red, aes(x = sulphates, y= free.sulfur.dioxide)) +
  geom_point(aes(color = 'orange'), alpha = 1/5, position = 'jitter') +
  scale_x_continuous(breaks = seq(0,max(red$sulphates),.1))+
  scale_y_continuous(breaks = seq(0,max(red$free.sulfur.dioxide),2)) +
  coord_cartesian(xlim = c(min(red$sulphates),
                           quantile(red$sulphates,0.99)),
                  ylim = c(min(red$free.sulfur.dioxide),
                           quantile(red$free.sulfur.dioxide,0.99))) +
  geom_smooth()
```

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. How did the feature(s) of interest vary with other features in \
the dataset?

**Alcohol $ residual.sugar: even by omitting the top 1% and zooming in, \ 
I still see no relation between the alcohol and residual.sugar.**
 
**Volatile.acidity & quality: I can see with the lower values of \
volatile.acidity the quality increases**
 
**Alcohol & quality: the increase of alcohol indeed increases the quality** 

**Alcohol & density: I can see a -ve correlation between these 2 features, \
I will these against quality to see how do they contribute to it.**
 **Quality & density: at a first look on the scatter I couldn't find a relation \
but after adding 2 geom_line of median and mean , I can tell that on average \
lower density can mean a better quality.**

### Did you observe any interesting relationships between the other features \
(not the main feature(s) of interest)?

**Chlorides & Quality: I don't see a relation between these 2.**

**Total.sulfur.dioxide & quality: generally a lower values of TSD can mean a \ 
better quality this relation needs to be investigated further with more \
variables**
 
**Alcohol & sulphates: there is a relation especially between sulphate value \
 0.4 and 0.8**
 
**Chlorides & Quality: I don't see a relation between these 2.**
 
**Free.sulfur.dioxide & sulphates: there is no direct relation seen in the graph**

### What was the strongest relationship you found?

- Alcohol & quality
- Alcohol & density

# Multivariate Plots Section

```{r alcohol_density_quality, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = red, aes(x = alcohol, y= density)) +
  geom_point(color = 'green', alpha = 0.8, position = 'jitter') +
  scale_x_continuous(breaks = seq(0,max(red$alcohol),.5))+
  scale_y_continuous(breaks = seq(0,max(red$density),0.005)) +
  coord_cartesian(xlim = c(min(red$alcohol),
                           quantile(red$alcohol,0.99)),
                  ylim = c(min(red$density),
                           quantile(red$density,0.99))) +
  facet_wrap(~quality) +
  geom_smooth() +
  geom_line(stat = 'summary', fun.y = median, color = 'red', linetype = 4) +
  geom_line(stat = 'summary', fun.y = mean, color = 'yellow', linetype = 2)
```

```{r echo=FALSE, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = red, aes(x = alcohol, y= volatile.acidity)) +
  geom_point(color = '#F23545', alpha = 0.8) +
  scale_x_continuous(breaks = seq(0,max(red$alcohol),.5))+
  scale_y_continuous(breaks = seq(0,max(red$volatile.acidity),0.1)) +
  coord_cartesian(xlim = c(min(red$alcohol),
                           quantile(red$alcohol,0.99)),
                  ylim = c(min(red$volatile.acidity),
                           quantile(red$volatile.acidity,0.99))) +
  facet_wrap(~quality) +
  geom_smooth() +
  geom_line(stat = 'summary', fun.y = median, color = 'red', linetype = 4) +
  geom_line(stat = 'summary', fun.y = mean, color = 'yellow', linetype = 2)
```


```{r mean_groupping}
## grouping by quality and calculating the means for some features
quality_groupped <- group_by(red,quality)

groupped_quality.means <- summarise(quality_groupped, 
                                mean_alcohol = mean(alcohol),
                                mean_density = mean(density),
                                mean_residual.sugar = mean(residual.sugar),
                                mean_volatile_acidity = mean(volatile.acidity),
                                mean_citric.acid = mean(citric.acid))
```


```{r echo=FALSE, message=FALSE, warning=FALSE, quality_all.means}
ggplot(data = groupped_quality.means, aes(x = as.integer(as.vector(quality)))) +
  geom_line(aes(y = mean_alcohol) ,colour = 'black') +
  geom_line(aes(y = mean_residual.sugar), colour = 'red', linetype = 4) +
  geom_line(aes(y = mean_density), colour = 'blue', linetype = 4) +
  geom_line(aes(y = mean_volatile_acidity), colour = 'green', linetype = 4) +
  geom_line(aes(y = mean_citric.acid), colour = 'darkblue', linetype = 4) +
  scale_color_discrete(name = 'Means', 
                       labels = c('Alcohol','sugar','density','volatile','citric'))+
  xlab('Quality')
```

```{r echo=FALSE, message=FALSE, warning=FALSE, free.sulfur.dioxide_alcohol_quality}
ggplot(data = red, aes(x = alcohol, y = free.sulfur.dioxide)) +
  facet_wrap(~quality) +
  geom_smooth()
```

```{r echo=FALSE, message=FALSE, warning=FALSE, cutting_pH}
## Testing with cutting a pH
red$pH.bucket <- cut(red$pH, c(2.740,3.210,3.310,3.311,3.400))

ggplot(data = subset(red, !is.na(pH.bucket)), 
       aes(x = as.integer(as.vector(quality)), y = alcohol)) +
  geom_smooth(aes(colour = pH.bucket))
```


```{r echo=FALSE, message=FALSE, warning=FALSE, cutting_tsd}
## Testing with cutting a total.sulfur.dioxide
 red$tsd.bucket <- cut(red$total.sulfur.dioxide, c(1,10,20,30,40,50,60))

ggplot(data = subset(red, !is.na(tsd.bucket)), aes( x = alcohol, y = density)) +
  geom_point(aes(color = tsd.bucket), alpha = 1/2, position = 'jitter') +
  facet_wrap(~quality)
```

```{r echo=FALSE, message=FALSE, warning=FALSE,alcohol_density_c_quality}
ggplot(data = subset(red, !is.na(tsd.bucket)), aes( x = alcohol, y = density)) +
  geom_point(aes(color = quality), alpha = 1/3, position = 'jitter') +
  coord_cartesian(xlim = c(8.40, quantile(red$alcohol,0.99)),
                  ylim = c(0.9901, quantile(red$density, 0.99))) +
  scale_color_discrete(guide = guide_legend(reverse=TRUE))
```

**Quality levels 6,7,8 sets on average between 11,13 of alcohol, and between \
0.996 and 0.993, so higher alcohol lower density does affect the quality of red \
wine**

```{r echo=FALSE, message=FALSE, warning=FALSE, densit_alcohol_quality_rs.bucket}
red$residual.sugar.bucket <- cut(red$residual.sugar,c(1,3,4,6,8,9))

ggplot(data = subset(red, !is.na(residual.sugar.bucket)), 
       aes( x = alcohol, y = density)) +
  geom_point(aes(color = quality) , alpha = 1, position = 'jitter') +
  coord_cartesian(xlim = c(8.40, quantile(red$alcohol,0.99)),
                  ylim = c(0.9901, quantile(red$density, 0.99))) +
  scale_color_discrete(guide = guide_legend(reverse=TRUE)) + 
  facet_wrap(~residual.sugar.bucket)
```

**Resudual.sugar does have an influance on the quality, as in the plot, we see \
points concentation in bucket (1,3] and (3,4], so in conclusion residual.sugar \
is an contributing factor for the quality**


```{r echo=FALSE, message=FALSE, warning=FALSE, fsd_sulphates_quality}
ggplot(data = red, aes(x = sulphates, y= free.sulfur.dioxide)) +
  geom_point(aes(color = 'orange'), alpha = 1/5, position = 'jitter') +
  scale_x_continuous(breaks = seq(0,max(red$sulphates),.1))+
  scale_y_continuous(breaks = seq(0,max(red$free.sulfur.dioxide),2)) +
  coord_cartesian(xlim = c(min(red$sulphates),
                           quantile(red$sulphates,0.99)),
                  ylim = c(min(red$free.sulfur.dioxide),
                           quantile(red$free.sulfur.dioxide,0.99))) +
  geom_smooth() +
  facet_wrap(~quality)
```

**With sulphates value on average increases quality does increase**

```{r echo=FALSE, message=FALSE, warning=FALSE, sulphates_alcohol_quality}
ggplot(data = red, aes(x = sulphates, y= alcohol)) +
  geom_point(aes(color = 'orange'), alpha = 1/5, position = 'jitter') +
  scale_x_continuous(breaks = seq(0,max(red$sulphates),.1))+
  scale_y_continuous(breaks = seq(0,max(red$alcohol),2)) +
  coord_cartesian(xlim = c(min(red$sulphates),
                           quantile(red$sulphates,0.99)),
                  ylim = c(min(red$alcohol),
                           quantile(red$alcohol,0.99))) +
  geom_smooth() +
  facet_wrap(~quality)
```

**Sulphates with alcohol does affect the quality as seen in the plot**

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. Were there features that strengthened each other in terms of \
looking at your feature(s) of interest?

**I have used alcohol, density and residual.sugar with quality, these features \
does have a good infleunce of the quality**

### Interesting relation in the EDA.

**I have found out that on average a sulphates value of around 0.8 can mean a \
good quality red wine**

**Sulphates is an interesting feature I wasn't expecting to have an impact on \
red wine quality**
------

# Final Plots and Summary

### Plot One

```{r echo=FALSE, Plot_One}
ggplot(data = subset(red, !is.na(residual.sugar.bucket)), aes( x = alcohol, y =
                                                                 density)) +
  geom_point(aes(color = quality) , alpha = 1, position = 'jitter') +
  coord_cartesian(xlim = c(8.40, quantile(red$alcohol,0.99)),
                  ylim = c(0.9901, quantile(red$density, 0.99))) +
  scale_color_discrete(guide = guide_legend(reverse=TRUE)) + 
  facet_wrap(~residual.sugar.bucket)
```


### Description One

**This plot clearly show what contributies to better quality, as we see in the \
first 2 buckets from top left we have almost no red and yellow points**

### Plot Two

```{r echo=FALSE, Plot_Two}
ggplot(data = red, aes(y = alcohol, x= as.integer(as.vector(quality)))) +
  geom_point(alpha = .06, position = 'jitter') +
  scale_y_continuous(breaks = seq(0,quantile(red$alcohol,0.99),0.5))+
  scale_x_continuous(breaks = seq(3,
                              quantile(with(red,as.integer(as.vector(quality)))
                                           ,0.99))) +
  coord_cartesian(ylim = c(min(red$alcohol),
                           quantile(red$alcohol,0.99)),
                  xlim = c(3,
                           quantile(with(red,as.integer(as.vector(quality)))
                                    ,0.99))) +
  xlab('Quality')+
  geom_line(stat = 'summary', fun.y = median, color = 'red') +
  geom_line(stat = 'summary', fun.y = mean, color = 'blue')
```

### Description Two

**This plot show the strong relation between  alcohol and quality, adding the \
median and mean lines shows this clearly**

### Plot Three

```{r echo=FALSE, Plot_Three}
ggplot(data = red, aes(y = volatile.acidity, 
                       x= as.integer(as.vector(quality)))) +
  geom_point(alpha = .3, position = 'jitter') +
  scale_y_continuous(breaks = seq(0,quantile(red$volatile.acidity,0.99),.1))+
  scale_x_continuous(breaks = seq(3,quantile(with(red,
                                      as.integer(as.vector(quality))),0.99))) +
  coord_cartesian(ylim = c(min(red$volatile.acidity),
                           quantile(red$volatile.acidity,0.99)),
                  xlim = c(3,
                           quantile(with(red,
                                      as.integer(as.vector(quality))),0.99))) +
  xlab('Quality') +
  geom_line(stat = 'summary', fun.y = mean)
```

### Description Three

**This plot yet shows another relation between quality and volatile.acidity, \
and its expressed evenmore with mean line of volatile.acidity**



# Reflection

**I guess not having enough samples of very high quality of red wine made this \
analysis a bit tougher, the same can be said on the very low quality of red \
wine, but in the end I found some interesting findings of some features like \
sulphates, and I was successful in assiging some main features in the begining \
of my analysis. In the end it was a good analysis, I will look into a bigger \
dataset with data more distributed accross different level of qualites**
